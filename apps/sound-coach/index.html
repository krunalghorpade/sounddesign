<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>100-Day Sound Design Dashboard</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>

    <nav id="sidebar">
        <!-- ... existing sidebar ... -->
        <!-- Back Link -->
        <a href="../../index.html"
            style="display: flex; align-items: center; gap: 5px; color: var(--color-text-muted); text-decoration: none; font-size: 13px; font-weight: 600; margin-bottom: 20px; transition: color 0.2s;">
            <span>‚Üê</span> Back to Gymkhana
        </a>

        <h1>
            <span
                style="background: var(--color-primary); color: white; border-radius: 8px; padding: 5px 10px;">SD</span>
            Sound Design Coach
        </h1>

        <div class="user-profile-section">
            <div class="user-avatar">üë§</div>
            <div id="profile-name" style="font-weight: 700; color: var(--color-text-main); margin-bottom: 5px;">Guest
            </div>
            <div id="challenge-start-date" style="font-size: 11px; color: var(--color-text-muted);">Start: --</div>
        </div>

        <div style="margin-bottom: 30px;">
            <div class="menu-item active" id="nav-dashboard-btn">
                <span style="margin-right: 10px;">üìä</span> Dashboard
            </div>
            <div class="menu-item" id="nav-analytics-btn">
                <span style="margin-right: 10px;">üìà</span> Analytics
            </div>
            <div class="menu-item" id="view-all-tasks-btn-sidebar">
                <span style="margin-right: 10px;">üìù</span> All Tasks
            </div>
        </div>

        <div style="margin-top: auto;">
            <p style="font-size: 12px; font-weight: 600; margin-bottom: 10px; color: var(--color-text-muted);">YOUR
                PROGRESS</p>
            <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px;">
                <span>Day <span id="current-day">0</span></span>
                <span>100 Days</span>
            </div>
            <div class="progress-container">
                <div id="progress-bar" style="width: 0%;"></div>
            </div>

            <button id="reset-challenge-btn" class="btn-secondary"
                style="width: 100%; margin-top: 20px; border: 1px dashed var(--color-danger); color: var(--color-danger); font-size: 12px;">
                Reset Progress
            </button>

            <!-- Made by Kratex Small Block -->
            <div
                style="margin-top: 30px; border-top: 1px solid var(--color-border); padding-top: 20px; text-align: center;">
                <div
                    style="font-size: 10px; font-weight: 600; color: var(--color-text-muted); text-transform: uppercase;">
                    M-HOUSE PIONEER</div>
                <div style="font-size: 13px; font-weight: 700; margin-top: 2px;">
                    Made by <a href="../../about.html"
                        style="color: var(--color-primary); text-decoration: none;">Kratex‚Ñ¢</a>
                </div>
            </div>
        </div>
    </nav>

    <div id="dashboard-main">
        <header id="dashboard-header"
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
            <div>
                <h2 id="main-header-title">Dashboard</h2>
                <div id="user-greeting">Welcome back, <span id="display-user-name">Guest</span>.</div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
                <button onclick="KratexApp.openModal('share-modal')" class="icon-btn" title="Share"><i
                        class="fas fa-share-alt"></i></button>
                <button onclick="KratexApp.openModal('settings-modal')" class="icon-btn" title="Settings"><i
                        class="fas fa-cog"></i></button>
                <button id="theme-toggle-btn" class="icon-btn" title="Toggle Theme"><i id="theme-icon"
                        class="fas fa-moon"></i></button>
                <button id="nav-auth-trigger" class="btn-secondary"
                    style="padding: 5px 15px; font-size: 0.8em; height: 32px; min-width: 80px;">Login</button>
            </div>
        </header>

        <!-- NOT STARTED STATE -->
        <div id="not-started-panel" class="card-panel"
            style="text-align: center; padding: 60px; max-width: 600px; margin: 0 auto; display: none;">
            <h2 style="color: var(--color-primary); margin-bottom: 15px;">Sound Design Coach</h2>
            <p style="margin-bottom: 30px;">Commit to 100 days of sound design mastery. Track your progress, build a
                streak, and evolve your sound.</p>
            <button id="begin-challenge-btn" class="btn-primary">Start 100-Day Challenge</button>
        </div>

        <!-- ACTIVE DASHBOARD STATE -->
        <div class="dashboard-grid" id="started-dashboard" style="display: none;">

            <!-- Stats Row -->
            <div id="progress-stats-container">
                <div class="stat-box">
                    <p>Total Completed</p>
                    <h3 id="current-day-stat">0</h3>
                </div>
                <div class="stat-box">
                    <p>Days Remaining</p>
                    <h3 id="remaining-days-stat" style="color: var(--color-primary);">100</h3>
                </div>
                <div class="stat-box">
                    <p>Current Streak</p>
                    <h3 id="streak-stat" style="color: var(--color-success);">0</h3>
                </div>
            </div>

            <!-- Daily Challenge Card -->
            <section id="daily-challenge" class="card-panel">
                <div
                    style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                    <span
                        style="background: rgba(74, 108, 247, 0.1); color: var(--color-primary); padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 700;">TODAY'S
                        TASK</span>
                </div>

                <h2 id="challenge-title">Loading...</h2>
                <p id="challenge-description"
                    style="font-size: 16px; color: var(--color-text-main); margin-bottom: 25px;">
                    Your daily challenge will appear here.
                </p>

                <div class="challenge-highlight-box">
                    <div>
                        <span class="challenge-label">Primary Plugin</span>
                        <div id="plugin-focus" class="challenge-value">N/A</div>
                    </div>
                    <div>
                        <span class="challenge-label">Reference Track</span>
                        <div id="track-reference" class="challenge-value">N/A</div>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <button id="mark-complete-btn" class="btn-primary">Mark Day Complete</button>
                </div>
            </section>

            <!-- Streak / Commitment Status -->
            <div id="streak-lockout" class="card-panel">
                <h3>Commitment</h3>
                <div class="info-box-secondary"
                    style="margin: 20px 0; padding: 20px; border-radius: 12px; text-align: center;">
                    <div id="streak-display" style="font-size: 24px; font-weight: 700; color: var(--color-success);">
                        0 Day Streak
                    </div>
                    <div style="font-size: 12px; color: var(--color-text-muted); margin-top: 5px;">Keep it up!</div>
                </div>

                <p id="time-remaining-message"
                    style="text-align: center; color: var(--color-warning); font-weight: 600; display: none;"></p>

                <button id="view-all-tasks-btn" class="btn-secondary" style="width: 100%;">View Full Roadmap</button>
            </div>
        </div>

        <!-- ANALYTICS DASHBOARD STATE -->
        <div class="dashboard-grid" id="analytics-dashboard" style="display: none;">
            <!-- ... analytics ... -->
            <!-- Stats Row -->
            <div style="grid-column: span 12; display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px;">
                <div class="stat-box">
                    <p>Completion Rate</p>
                    <h3 id="analytics-completion-rate">0%</h3>
                </div>
                <div class="stat-box">
                    <p>Avg Difficulty</p>
                    <h3 id="analytics-avg-difficulty" style="color: var(--color-warning);">0.0</h3>
                </div>
                <div class="stat-box">
                    <p>Techniques Learned</p>
                    <h3 id="analytics-total-learned" style="color: var(--color-secondary);">0</h3>
                </div>
            </div>

            <!-- Difficulty Chart -->
            <div class="card-panel" style="grid-column: span 8;">
                <h3>Difficulty Distribution</h3>
                <p style="font-size: 13px; margin-bottom: 20px;">How you rated the difficulty of completed challenges
                    (1-5).</p>

                <div class="chart-container" id="difficulty-chart">
                    <!-- Bars injected via JS -->
                </div>
            </div>

            <!-- Recent Insights -->
            <div class="card-panel" style="grid-column: span 4; display: flex; flex-direction: column;">
                <h3>Recent Insights</h3>
                <p style="font-size: 13px; margin-bottom: 15px;">Latest things you've learned.</p>
                <div id="recent-insights-list" style="overflow-y: auto; flex-grow: 1; max-height: 300px;">
                    <div style="color: var(--color-text-muted); font-size: 13px; font-style: italic;">No data yet.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ... Modals ... -->
    <!-- Begin Challenge Modal (Updated Trigger in script) -->
    <!-- ... -->
    <!-- (I am not including the entire modal content here to save space as replace_file_content does exact matching, I'll rely on the EndLine 101 to match the top part primarily then assume rest is same?) -->
    <!-- Wait, replace_file_content requires TargetContent to look for. I cannot just pass PART of the file. -->
    <!-- I will target the header section specifically. -->


    <!-- ACTIVE DASHBOARD STATE -->
    <div class="dashboard-grid" id="started-dashboard" style="display: none;">

        <!-- Stats Row -->
        <div id="progress-stats-container">
            <div class="stat-box">
                <p>Total Completed</p>
                <h3 id="current-day-stat">0</h3>
            </div>
            <div class="stat-box">
                <p>Days Remaining</p>
                <h3 id="remaining-days-stat" style="color: var(--color-primary);">100</h3>
            </div>
            <div class="stat-box">
                <p>Current Streak</p>
                <h3 id="streak-stat" style="color: var(--color-success);">0</h3>
            </div>
        </div>

        <!-- Daily Challenge Card -->
        <section id="daily-challenge" class="card-panel">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                <span
                    style="background: rgba(74, 108, 247, 0.1); color: var(--color-primary); padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 700;">TODAY'S
                    TASK</span>
            </div>

            <h2 id="challenge-title">Loading...</h2>
            <p id="challenge-description" style="font-size: 16px; color: var(--color-text-main); margin-bottom: 25px;">
                Your daily challenge will appear here.
            </p>

            <div class="challenge-highlight-box">
                <div>
                    <span class="challenge-label">Primary Plugin</span>
                    <div id="plugin-focus" class="challenge-value">N/A</div>
                </div>
                <div>
                    <span class="challenge-label">Reference Track</span>
                    <div id="track-reference" class="challenge-value">N/A</div>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <button id="mark-complete-btn" class="btn-primary">Mark Day Complete</button>
            </div>
        </section>

        <!-- Streak / Commitment Status -->
        <div id="streak-lockout" class="card-panel">
            <h3>Commitment</h3>
            <div class="info-box-secondary"
                style="margin: 20px 0; padding: 20px; border-radius: 12px; text-align: center;">
                <div id="streak-display" style="font-size: 24px; font-weight: 700; color: var(--color-success);">
                    0 Day Streak
                </div>
                <div style="font-size: 12px; color: var(--color-text-muted); margin-top: 5px;">Keep it up!</div>
            </div>

            <p id="time-remaining-message"
                style="text-align: center; color: var(--color-warning); font-weight: 600; display: none;"></p>

            <button id="view-all-tasks-btn" class="btn-secondary" style="width: 100%;">View Full Roadmap</button>
        </div>
    </div>

    <!-- ANALYTICS DASHBOARD STATE -->
    <div class="dashboard-grid" id="analytics-dashboard" style="display: none;">

        <!-- Analytics Stats Row -->
        <div style="grid-column: span 12; display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px;">
            <div class="stat-box">
                <p>Completion Rate</p>
                <h3 id="analytics-completion-rate">0%</h3>
            </div>
            <div class="stat-box">
                <p>Avg Difficulty</p>
                <h3 id="analytics-avg-difficulty" style="color: var(--color-warning);">0.0</h3>
            </div>
            <div class="stat-box">
                <p>Techniques Learned</p>
                <h3 id="analytics-total-learned" style="color: var(--color-secondary);">0</h3>
            </div>
        </div>

        <!-- Difficulty Chart -->
        <div class="card-panel" style="grid-column: span 8;">
            <h3>Difficulty Distribution</h3>
            <p style="font-size: 13px; margin-bottom: 20px;">How you rated the difficulty of completed challenges
                (1-5).</p>

            <div class="chart-container" id="difficulty-chart">
                <!-- Bars injected via JS -->
            </div>
        </div>

        <!-- Recent Insights -->
        <div class="card-panel" style="grid-column: span 4; display: flex; flex-direction: column;">
            <h3>Recent Insights</h3>
            <p style="font-size: 13px; margin-bottom: 15px;">Latest things you've learned.</p>
            <div id="recent-insights-list" style="overflow-y: auto; flex-grow: 1; max-height: 300px;">
                <div style="color: var(--color-text-muted); font-size: 13px; font-style: italic;">No data yet.</div>
            </div>
        </div>
    </div>
    </div>

    <!-- MODALS -->

    <!-- Begin Challenge Modal -->
    <div id="begin-challenge-modal" class="nb-modal-backdrop"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; align-items: center; justify-content: center;">
        <div class="nb-modal-content" style="padding: 40px; position: relative;">
            <button class="close-modal-btn"
                onclick="document.getElementById('begin-challenge-modal').style.display='none';">√ó</button>
            <h2 style="color: var(--color-primary); margin-top: 0;">Setup Profile</h2>
            <form id="begin-challenge-form">
                <div style="margin-bottom: 20px;">
                    <label for="user-name-input">Your Name / Alias</label>
                    <input type="text" id="user-name-input" required placeholder="Ex. SoundWave">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="daw-select">Preferred DAW</label>
                    <select id="daw-select" required>
                        <option value="ableton">Ableton Live</option>
                        <option value="flstudio">FL Studio</option>
                        <option value="protools">Pro Tools</option>
                        <option value="any">Any / Other</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="genre-select">Preferred Genre</label>
                    <select id="genre-select" required>
                        <option value="pop">Pop</option>
                        <option value="hiphop">Hip‚ÄëHop</option>
                        <option value="electronic">Electronic</option>
                        <option value="any">Anything</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="start-date-input">Start Date</label>
                    <input type="date" id="start-date-input" required readonly
                        style="background-color: var(--color-input-bg); color: var(--color-text-muted);">
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Start Journey</button>
            </form>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-confirmation-modal" class="nb-modal-backdrop"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; align-items: center; justify-content: center;">
        <div class="nb-modal-content" style="padding: 40px; text-align: center;">
            <h2 style="color: var(--color-danger); margin-top: 0;">Reset All Progress?</h2>
            <p>This action cannot be undone. You will lose your streak and completion history.</p>
            <div style="margin-top: 30px; display: grid; gap: 10px;">
                <button id="confirm-reset-btn" class="btn-primary"
                    style="background: var(--color-danger); box-shadow: 0 10px 20px rgba(238, 93, 80, 0.25);">Yes,
                    Reset Everything</button>
                <button onclick="document.getElementById('reset-confirmation-modal').style.display='none';"
                    class="btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Reflection Modal -->
    <div id="reflection-form-modal" class="nb-modal-backdrop"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; align-items: center; justify-content: center;">
        <div id="reflection-form-content" class="nb-modal-content" style="padding: 40px;">
            <h2 style="margin-top: 0;">Day <span id="modal-day-num">0</span> Reflection</h2>
            <form id="reflection-form">

                <div style="margin-bottom: 25px;">
                    <label>Difficulty Rating <span id="difficulty-val"
                            style="color: var(--color-primary); margin-left: 5px;">3</span>/5</label>
                    <div class="radio-group" style="margin-top: 10px;">
                        <label class="radio-option">
                            <input type="radio" name="difficulty" value="1" required>
                            <span class="radio-label">1</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="difficulty" value="2">
                            <span class="radio-label">2</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="difficulty" value="3" checked>
                            <span class="radio-label">3</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="difficulty" value="4">
                            <span class="radio-label">4</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="difficulty" value="5">
                            <span class="radio-label">5</span>
                        </label>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <label for="new-technique">One thing you learned</label>
                    <input type="text" id="new-technique" placeholder="Ex. New shortcut, plugin trick..." required>
                </div>

                <div style="margin-bottom: 20px;">
                    <label for="reflection-notes">Notes</label>
                    <textarea id="reflection-notes" rows="2" required
                        placeholder="What worked well? What didn't?"></textarea>
                </div>

                <div style="margin-bottom: 30px;">
                    <label>Upload Audio (WAV/MP3)</label>
                    <input type="file" id="audio-file-input" accept=".wav,.mp3,audio/*" style="display: none;">
                    <label for="audio-file-input" class="file-upload-wrapper">
                        <span style="font-size: 24px; margin-bottom: 5px;">üì§</span>
                        <span class="file-upload-text" id="file-upload-name">Click to upload your creation</span>
                    </label>
                </div>

                <div style="display: flex; gap: 15px;">
                    <button type="submit" id="submit-reflection-btn" class="btn-primary" style="flex: 2;">Complete
                        Day</button>
                    <button type="button" class="btn-secondary"
                        onclick="document.getElementById('reflection-form-modal').style.display='none';"
                        style="flex: 1;">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- All Tasks Modal -->
    <div id="all-tasks-modal" class="nb-modal-backdrop"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; align-items: center; justify-content: center;">
        <div id="all-tasks-content" class="nb-modal-content"
            style="padding: 40px; max-width: 800px; height: 80vh; display: flex; flex-direction: column; position: relative;">
            <button class="close-modal-btn"
                onclick="document.getElementById('all-tasks-modal').style.display='none';">√ó</button>
            <div style="margin-bottom: 20px;">
                <h2 style="margin: 0;">Full Roadmap</h2>
            </div>

            <div id="task-list-container" style="flex-grow: 1; overflow-y: auto; padding-right: 15px;">
                <!-- Tasks injected here -->
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav id="mobile-bottom-nav">
        <div class="mobile-nav-item active" id="mobile-nav-dashboard-btn">
            <span class="mobile-nav-icon">üìä</span>
            <span class="mobile-nav-label">Dashboard</span>
        </div>
        <div class="mobile-nav-item" id="mobile-nav-analytics-btn">
            <span class="mobile-nav-icon">üìà</span>
            <span class="mobile-nav-label">Stats</span>
        </div>
        <div class="mobile-nav-item" id="mobile-nav-tasks-btn">
            <span class="mobile-nav-icon">üìù</span>
            <span class="mobile-nav-label">Tasks</span>
        </div>
    </nav>

    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="nb-modal-backdrop"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; align-items: center; justify-content: center;">
        <div class="nb-modal-content" style="padding: 40px; max-width: 450px;">
            <div id="onboarding-content">
                <!-- Step 1 -->
                <div class="onboarding-step active" data-step="1">
                    <span class="onboarding-image">üëã</span>
                    <h2>Welcome to Sound Design Coach</h2>
                    <p>Your journey to mastering sound design starts here. Over the next 100 days, you'll tackle daily
                        challenges to build your skills layer by layer.</p>
                </div>

                <!-- Step 2 -->
                <div class="onboarding-step" data-step="2">
                    <span class="onboarding-image">üéß</span>
                    <h2>How It Works</h2>
                    <p>1. <strong>Do the Task:</strong> Read the daily challenge and create the sound.<br>
                        2. <strong>Upload & Reflect:</strong> Save your preset/audio and write what you learned.<br>
                        3. <strong>Build Streak:</strong> Consistency is key. Keeping the streak alive unlocks new
                        habits.</p>
                </div>

                <!-- Step 3 -->
                <div class="onboarding-step" data-step="3">
                    <span class="onboarding-image">üöÄ</span>
                    <h2>Ready to Begin?</h2>
                    <p>This isn't just about reading‚Äîit's about doing. Open your DAW, set up your profile, and let's
                        make some noise!</p>
                </div>
            </div>

            <!-- Dots -->
            <div class="step-dots">
                <div class="step-dot active" data-dot="1"></div>
                <div class="step-dot" data-dot="2"></div>
                <div class="step-dot" data-dot="3"></div>
            </div>

            <!-- Footer -->
            <div class="onboarding-footer">
                <label class="checkbox-label">
                    <input type="checkbox" id="dont-show-onboarding">
                    Don't show me again
                </label>
                <div style="display: flex; gap: 10px;">
                    <button id="onboarding-skip-btn" class="btn-secondary"
                        style="padding: 8px 16px; font-size: 12px; border: none; color: var(--color-text-muted);">Skip</button>
                    <button id="onboarding-next-btn" class="btn-primary"
                        style="padding: 8px 20px; font-size: 13px;">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../js/global.js"></script>
    <script src="script.js"></script>
</body>

</html>